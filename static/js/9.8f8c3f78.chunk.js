(this["webpackJsonpluminour-react-challenge"]=this["webpackJsonpluminour-react-challenge"]||[]).push([[9],{155:function(e,t,n){"use strict";var r=n(10),a=n.n(r),c=n(16),u=n(36),o=n(13),i=n(30),s=function(){return JSON.parse(localStorage.getItem("carts")||"[]")},l=function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.l)(100);case 2:return n=s().find((function(e){return e.userId===t}))||{items:[]},e.abrupt("return",n.items);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(c.a)(a.a.mark((function e(t,n){var r,c,u,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s(),c={userId:t,items:n},u=[],(i=r.find((function(e){return e.userId===t})))||(u=[].concat(Object(o.a)(r),[c])),i&&(u=r.map((function(e){return e.userId===t?c:e}))),a=u,localStorage.setItem("carts",JSON.stringify(a)),e.abrupt("return",c);case 8:case"end":return e.stop()}var a}),e)})));return function(t,n){return e.apply(this,arguments)}}();n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v}));var f=function(e){return{type:u.a.setItems,payload:{items:e}}},b=function(){return{type:u.a.fetchStart}},m=function(e){return{type:u.a.fetchEnd,payload:{errorMessage:e}}},p=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(b()),t.prev=1,t.next=4,l(e);case 4:r=t.sent,n(f(r)),n(m()),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0),n(m());case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},v=function(e,t){return function(){var n=Object(c.a)(a.a.mark((function n(r){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r(b()),n.prev=1,n.next=4,d(e,t);case 4:r(f(t)),r(m()),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(1),console.log(n.t0),r(m(n.t0.message));case 12:case"end":return n.stop()}}),n,null,[[1,8]])})));return function(e){return n.apply(this,arguments)}}()}},156:function(e,t,n){"use strict";var r=n(45),a=n(0),c=n(26),u=n(10),o=n.n(u),i=n(16),s=n(37),l=n(30),d=Object(l.c)("books"),f=d.getItems,b=d.createItems,m=d.updateItems,p=d.deleteItems,v=b,O=Object(l.k)(m),j=Object(l.k)(p),h=function(e){return{type:s.a.setBooks,payload:{books:e}}},g=function(e){return{type:s.a.updateBooks,payload:{books:e}}},k=function(e){return{type:s.a.deleteBooks,payload:{books:e}}},y=function(){return{type:s.a.fetchStart}},E=function(e){return{type:s.a.fetchEnd,payload:{errorMessage:e}}},x=n(49);n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return I}));var w=function(e){var t=Object(a.useState)(!e),n=Object(r.a)(t,2),u=n[0],s=n[1],d=Object(c.b)(),b=Object(c.c)((function(e){return e.books})),m=b.books,p=b.loading,O=b.hasLoaded,j=b.errorMessage;return Object(a.useEffect)((function(){O&&u||p||(s(!0),d(function(){var e=Object(i.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(y()),e.prev=1,e.next=4,f();case 4:if(0!==(n=e.sent).length){e.next=14;break}return e.next=8,Object(l.f)();case 8:return r=e.sent,e.next=11,v(r);case 11:return a=e.sent,t(h(a)),e.abrupt("return",t(E()));case 14:n.length>0&&(t(h(n)),t(E())),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(1),console.log(e.t0),t(E(e.t0.message));case 21:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}()))}),[O,p,e,d,u]),{books:m,loading:p,hasLoaded:O,errorMessage:j}},I=function(){var e=Object(c.b)(),t=Object(x.b)().me;return{addBooks:function(t){return e(function(e){return function(){var t=Object(i.a)(o.a.mark((function t(n){var r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(y()),t.prev=1,t.next=4,v(e);case 4:r=t.sent,n(h(r)),n(E()),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0),n(E(t.t0.message));case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()}(t))},deleteBooks:function(n){return t&&e(function(e,t){return function(){var n=Object(i.a)(o.a.mark((function n(r){var a;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r(y()),n.prev=1,n.next=4,j(e,t.map((function(e){return e.id})));case 4:a=n.sent,r(k(a)),r(E()),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(1),console.log(n.t0),r(E(n.t0.message));case 13:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e){return n.apply(this,arguments)}}()}(t,n))},updateBooks:function(n){return t&&e(function(e,t){return function(){var n=Object(i.a)(o.a.mark((function n(r){var a;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r(y()),n.prev=1,n.next=4,O(e,t);case 4:a=n.sent,r(g(a)),r(E()),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(1),console.log(n.t0),r(E(n.t0.message));case 13:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e){return n.apply(this,arguments)}}()}(t,n))}}}},157:function(e,t,n){"use strict";var r=n(45),a=n(6),c=n(26),u=n(56),o=n(10),i=n.n(o),s=n(16),l=n(18),d=n(30),f=Object(d.c)("orders"),b=f.getItems,m=f.createItems,p=f.updateItems,v=b,O=m,j=p,h=function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:return n=e.sent,e.abrupt("return",n.filter((function(e){return e.buyer.id===t})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=n(155),k=function(e){return{type:l.a.setOrders,payload:{orders:e}}},y=function(e){return{type:l.a.updateOrders,payload:{orders:e}}},E=function(){return{type:l.a.fetchStart}},x=function(){return{type:l.a.fetchEnd}},w=function(e){return function(){var t=Object(s.a)(i.a.mark((function t(n){var r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(E()),t.prev=1,t.next=4,h(e);case 4:r=t.sent,n(k(r)),n(x()),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(1),console.log(t.t0),n(x());case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},I=function(e){return function(){var t=Object(s.a)(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(E()),t.prev=1,t.next=4,j(e);case 4:n(y(e)),n(x()),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0),n(x());case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},C=n(49),S=n(0);n.d(t,"d",(function(){return N})),n.d(t,"c",(function(){return M})),n.d(t,"a",(function(){return B})),n.d(t,"b",(function(){return L}));var N=function(){return Object(c.c)((function(e){return e.orders}))},M=function(){var e=Object(c.b)();return{createOrder:function(t,n){return e((r={id:Object(u.uuid)(),buyer:{id:t.id,name:t.name,surname:t.surname,username:t.username},status:l.b.new,items:n},function(){var e=Object(s.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(E()),e.prev=1,e.next=4,O([r]);case 4:n=e.sent,t(k(n)),t(Object(g.b)(r.buyer.id,[])),t(x()),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0),t(x());case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()));var r},confirmOrder:function(t){return e(I([Object(a.a)({},t,{status:l.b.paid})]))},cancelOrder:function(t){return e(I([Object(a.a)({},t,{status:l.b.canceled})]))},updateOrder:function(t){return e(I([t]))}}},B=function(){var e=Object(c.b)(),t=Object(C.b)(),n=Object(c.c)((function(e){return e.orders}));return Object(S.useEffect)((function(){!n.hasLoaded&&!n.loading&&t.me&&t.me.id&&e(w(t.me.id))})),Object(a.a)({},n,{loading:t.loading||n.loading})},L=function(e){var t=Object(S.useState)(!1),n=Object(r.a)(t,2),a=n[0],u=n[1],o=Object(c.b)(),i=Object(c.c)((function(e){return e.orders})),s=i.orders,l=i.loading,d=i.hasLoaded;return Object(S.useEffect)((function(){!e||a||l||(u(!0),o(w(e)))}),[e,l,o,a]),{orders:s,loading:l,hasLoaded:d}}},179:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(156),u=n(143),o=n(166),i=n(1),s=n(2),l=(n(5),n(3)),d=n(112),f=n(4),b=a.a.forwardRef((function(e,t){var n=e.classes,r=e.className,c=e.raised,u=void 0!==c&&c,o=Object(s.a)(e,["classes","className","raised"]);return a.a.createElement(d.a,Object(i.a)({className:Object(l.a)(n.root,r),elevation:u?8:1,ref:t},o))})),m=Object(f.a)({root:{overflow:"hidden"}},{name:"MuiCard"})(b),p=["video","audio","picture","iframe","img"],v=a.a.forwardRef((function(e,t){var n=e.children,r=e.classes,c=e.className,u=e.component,o=void 0===u?"div":u,d=e.image,f=e.src,b=e.style,m=Object(s.a)(e,["children","classes","className","component","image","src","style"]),v=-1!==p.indexOf(o),O=!v&&d?Object(i.a)({backgroundImage:'url("'.concat(d,'")')},b):b;return a.a.createElement(o,Object(i.a)({className:Object(l.a)(r.root,c,v&&r.media,-1!=="picture img".indexOf(o)&&r.img),ref:t,style:O,src:v?d||f:void 0},m),n)})),O=Object(f.a)({root:{display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},media:{width:"100%"},img:{objectFit:"cover"}},{name:"MuiCardMedia"})(v),j=a.a.forwardRef((function(e,t){var n=e.classes,r=e.className,c=e.component,u=void 0===c?"div":c,o=Object(s.a)(e,["classes","className","component"]);return a.a.createElement(u,Object(i.a)({className:Object(l.a)(n.root,r),ref:t},o))})),h=Object(f.a)({root:{padding:16,"&:last-child":{paddingBottom:24}}},{name:"MuiCardContent"})(j),g=n(146),k=n(145),y=function(e){var t=e.book,n=e.handleClick,r=t.id,c=t.title,u=t.author,i=t.published_date,s=t.book_cover,l=t.quantity;return a.a.createElement(o.a,{item:!0,xs:12,sm:6,md:6,lg:3},a.a.createElement(m,{raised:!0},a.a.createElement(o.a,{container:!0,spacing:1,direction:"row",justify:"center",alignItems:"center"},a.a.createElement(o.a,{item:!0,xs:4,sm:3},a.a.createElement(O,{image:s,component:"img",title:"".concat(c," image")})),a.a.createElement(o.a,{item:!0,xs:8},a.a.createElement(h,null,a.a.createElement(o.a,{container:!0,direction:"column",wrap:"nowrap"},a.a.createElement(g.a,{noWrap:!0,component:"h6",variant:"h6"},c),a.a.createElement(g.a,{noWrap:!0,variant:"subtitle2",color:"textSecondary"},"ID: ".concat(r)),a.a.createElement(g.a,{variant:"subtitle2",color:"textSecondary"},u),a.a.createElement(g.a,{noWrap:!0,variant:"subtitle2",color:"textSecondary"},i),a.a.createElement(g.a,{noWrap:!0,variant:"subtitle2",color:"textSecondary"},"Quantity: ".concat(l)),a.a.createElement(o.a,{container:!0,spacing:1},a.a.createElement(k.a,{variant:"outlined",onClick:function(){return n(t)}},"Add to Cart"))))))))},E=n(26),x=n(155),w=n(30),I=function(){var e=Object(E.b)(),t=Object(E.c)((function(e){return e.cartItems})).items;return{addOrIncreaseItem:Object(r.useCallback)((function(n,r){if(!Object(w.d)(r.id,t)){var a=Object(w.a)(r,t);return e(Object(x.b)(n,a))}var c=Object(w.b)(r,t);return e(Object(x.b)(n,c))}),[t,e]),removeOrDecreaseItem:Object(r.useCallback)((function(n,r){var a=Object(w.d)(r.id,t);if(a&&1===a.quantity){var c=Object(w.h)(r,t);return e(Object(x.b)(n,c))}var u=Object(w.i)(r,t);return e(Object(x.b)(n,u))}),[t,e]),removeItem:Object(r.useCallback)((function(n,r){var a=t.filter((function(e){return e.id!==r.id}));return e(Object(x.b)(n,a))}),[t,e])}},C=n(45),S=n(49),N=n(181),M=n(144),B=n(170),L=n(171),q=n(182),R=n(172),W=n(157),J=function(){var e=Object(r.useState)(!1),t=Object(C.a)(e,2),n=t[0],c=t[1],i=Object(S.b)().me,s=function(e){var t=Object(E.b)(),n=Object(E.c)((function(e){return e.cartItems})),a=n.items,c=n.loading,u=n.hasLoaded;return Object(r.useEffect)((function(){!e||u||c||t(Object(x.a)(e))}),[e,u,c,t]),{items:a,loading:c,hasLoaded:u}}(i&&i.id||"").items,l=I(),d=l.addOrIncreaseItem,f=l.removeOrDecreaseItem,b=l.removeItem,m=Object(W.d)().loading,p=Object(W.c)().createOrder,v=s.reduce((function(e,t){return e+t.quantity}),0),O=function(e){return function(){return i&&i.id&&d(i.id,e)}},j=function(e){return function(){return i&&i.id&&f(i.id,e)}},h=function(e){return function(){return i&&i.id&&b(i.id,e)}};return i?a.a.createElement(o.a,{container:!0,justify:"flex-end"},m&&a.a.createElement(u.a,null),a.a.createElement(k.a,{disabled:!!m||0===s.length,onClick:function(){return v>0&&c(!0)}},"Cart: ".concat(v)),a.a.createElement(N.a,{anchor:"right",open:n,onClose:function(){return c(!1)}},a.a.createElement(o.a,{container:!0},a.a.createElement(M.a,null,s.map((function(e){return a.a.createElement(B.a,{key:"".concat(e.id),divider:!0},a.a.createElement(L.a,null,a.a.createElement(q.a,{alt:e.title,src:e.book_cover,variant:"square"})),a.a.createElement(R.a,{primary:e.title}),a.a.createElement("div",null,a.a.createElement(k.a,{onClick:j(e)},"<"),a.a.createElement("span",null,"Quantity: ".concat(e.quantity)),a.a.createElement(k.a,{onClick:O(e)},">")),a.a.createElement("div",null,a.a.createElement(k.a,{onClick:h(e)},"Remove")))})))),s.length>0&&a.a.createElement(o.a,{container:!0,justify:"center"},a.a.createElement(k.a,{onClick:function(){if(i)return c(!1),p(i,s)},variant:"contained",fullWidth:!1},"Create Order")))):null};t.default=function(){var e=Object(c.b)(),t=e.books,n=e.loading,r=I().addOrIncreaseItem,i=Object(S.b)().me,s=function(e){return i&&i.id&&r(i.id,e)};return a.a.createElement("div",null,n&&a.a.createElement(u.a,null),!n&&a.a.createElement(o.a,{container:!0,spacing:1},a.a.createElement(J,null),t.map((function(e){return a.a.createElement(y,{key:e.id,book:e,handleClick:s})}))))}}}]);
//# sourceMappingURL=9.8f8c3f78.chunk.js.map
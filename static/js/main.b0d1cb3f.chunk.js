(this["webpackJsonpluminour-react-challenge"]=this["webpackJsonpluminour-react-challenge"]||[]).push([[1],{111:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(12),u=n.n(c),o=n(81),s=n(20),i=n(26),d=n(147),f=n(148),l=n(143),b=n(63),m=n(62),p=n(74),h=n.n(p),O=n(19),v=n(13),j=n(6),k=n(9),g={users:[],loading:!1,hasLoaded:!1,errorMessage:""},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case k.a.setUsers:return Object(j.a)({},e,{users:r.users});case k.a.addUsers:return Object(j.a)({},e,{users:[].concat(Object(v.a)(r.users),Object(v.a)(e.users))});case k.a.fetchStart:return Object(j.a)({},e,{loading:!0});case k.a.fetchEnd:return Object(j.a)({},e,{errorMessage:r&&r.errorMessage||"",loading:!1,hasLoaded:!0});default:return e}},w=n(18),E=n(30),x={orders:[],loading:!1,hasLoaded:!1},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case w.a.setOrders:return Object(j.a)({},e,{orders:r.orders});case w.a.updateOrders:return Object(j.a)({},e,{orders:Object(E.j)(r.orders,e.orders)});case w.a.fetchStart:return Object(j.a)({},e,{loading:!0});case w.a.fetchEnd:return Object(j.a)({},e,{loading:!1,hasLoaded:!0});default:return e}},S=n(37),M={books:[],loading:!1,hasLoaded:!1,errorMessage:""},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case S.a.setBooks:return Object(j.a)({},e,{books:r.books});case S.a.addBooks:return Object(j.a)({},e,{books:[].concat(Object(v.a)(r.books),Object(v.a)(e.books))});case S.a.updateBooks:return Object(j.a)({},e,{books:Object(E.j)(r.books,e.books)});case S.a.deleteBooks:return Object(j.a)({},e,{books:e.books.filter((function(e){var t=e.id;return!r.books.find((function(e){return e.id===t}))}))});case S.a.fetchStart:return Object(j.a)({},e,{loading:!0});case S.a.fetchEnd:return Object(j.a)({},e,{loading:!1,hasLoaded:!0});default:return e}},B=n(36),U={items:[],loading:!1,hasLoaded:!1},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case B.a.setItems:return Object(j.a)({},e,{items:r.items});case B.a.addItems:return Object(j.a)({},e,{items:[].concat(Object(v.a)(r.items),Object(v.a)(e.items))});case B.a.updateItems:return Object(j.a)({},e,{items:Object(E.j)(r.items,e.items)});case B.a.removeItems:return Object(j.a)({},e,{items:Object(E.g)(r.items,e.items)});case B.a.fetchStart:return Object(j.a)({},e,{loading:!0});case B.a.fetchEnd:return Object(j.a)({},e,{loading:!1,hasLoaded:!0});default:return e}},z=n(42),N={me:null,loading:!1,hasLoaded:!1},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case z.a.set:return Object(j.a)({},e,{me:r.me});case z.a.clear:return N;default:return e}},J=Object(O.combineReducers)({users:y,orders:I,books:L,cartItems:q,me:C}),P={key:"root",storage:h.a,whitelist:["me"]},D=Object(m.a)(P,J),W=Object(b.a)({reducer:D,middleware:Object(b.b)({serializableCheck:!1})}),A=W,T=Object(m.b)(W),Y=n(138),_=n(150),K=n(142),R=n(49),$=n(46),F=function(){var e=Object(s.g)().pathname,t=Object(s.f)().push,n=Object(R.b)().me;return n?a.a.createElement(Y.a,null,a.a.createElement(_.a,{variant:"scrollable",value:"/".concat(e.split("/")[1])||!1,onChange:function(e,n){return t(n)}},Object.keys($.a).filter((function(e){return $.a[e].roles.includes(n.role)&&!$.a[e].noNav})).map((function(e){return a.a.createElement(K.a,{key:e,value:e,label:$.a[e].name})})))):null},G=n(45),H=n(57),Q=n(152),V=n(149),X=n(145),Z=n(146),ee=function(e){var t=e.children;Object(H.c)();var n=Object(H.b)(),c=n.authenticated,u=n.authenticate,o=n.errorMessage,s=n.loading,i=Object(r.useState)(""),d=Object(G.a)(i,2),f=d[0],b=d[1],m=Object(r.useState)(""),p=Object(G.a)(m,2),h=p[0],O=p[1];return c?a.a.createElement("div",null,t):a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),u(f,h)}},a.a.createElement(Q.a,{open:!!s},a.a.createElement(l.a,null)),a.a.createElement(V.a,{type:"text",label:"Username",fullWidth:!0,value:f,onChange:function(e){return b(e.target.value)},disabled:!!s,required:!0}),a.a.createElement(V.a,{type:"password",label:"Password",fullWidth:!0,value:h,onChange:function(e){return O(e.target.value)},disabled:!!s,required:!0}),a.a.createElement(X.a,{type:"submit"},"Login"),o&&a.a.createElement(Z.a,{variant:"h5",color:"error"},o))},te=n(80),ne=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(9)]).then(n.bind(null,179))})),re=Object(r.lazy)((function(){return n.e(6).then(n.bind(null,173))})),ae=Object(r.lazy)((function(){return n.e(11).then(n.bind(null,174))})),ce=Object(r.lazy)((function(){return n.e(4).then(n.bind(null,175))})),ue=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(8)]).then(n.bind(null,176))})),oe=Object(r.lazy)((function(){return n.e(5).then(n.bind(null,177))})),se=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,178))})),ie=Object(r.lazy)((function(){return n.e(10).then(n.bind(null,180))})),de=function(){return a.a.createElement(i.a,{store:A},a.a.createElement(te.a,{loading:null,persistor:T},a.a.createElement(d.a,null,a.a.createElement(o.a,{basename:"/luminour-react-challenge"},a.a.createElement(ee,null,a.a.createElement(F,null),a.a.createElement(f.a,null),a.a.createElement(r.Suspense,{fallback:a.a.createElement(l.a,null)},a.a.createElement(s.c,null,a.a.createElement(s.a,{path:"/",exact:!0,component:ne}),a.a.createElement(s.a,{path:"/book-list",exact:!0,component:ie}),a.a.createElement(s.a,{path:"/users",exact:!0,component:re}),a.a.createElement(s.a,{path:"/users/:userId/orders",exact:!0,component:oe}),a.a.createElement(s.a,{path:"/users/:userId/orders/:orderId",exact:!0,component:se}),a.a.createElement(s.a,{path:"/logout",exact:!0,component:ae}),a.a.createElement(s.a,{path:"/my-orders",exact:!0,component:ce}),a.a.createElement(s.a,{path:"/my-orders/:orderId",exact:!0,component:ue}))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(a.a.createElement(de,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},18:function(e,t,n){"use strict";var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.setOrders="orders/setOrders",e.updateOrders="oders/updateOrds",e.fetchStart="orders/fetchStart",e.fetchEnd="orders/fetchEnd"}(r||(r={})),function(e){e.new="new",e.paid="paid",e.sent="sent",e.canceled="canceled"}(a||(a={}))},30:function(e,t,n){"use strict";n.d(t,"l",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"j",(function(){return h})),n.d(t,"g",(function(){return O})),n.d(t,"f",(function(){return k})),n.d(t,"a",(function(){return g})),n.d(t,"h",(function(){return y})),n.d(t,"b",(function(){return w})),n.d(t,"i",(function(){return E})),n.d(t,"e",(function(){return x})),n.d(t,"k",(function(){return S})),n.d(t,"c",(function(){return M}));var r=n(2),a=n(82),c=n(7),u=n(6),o=n(13),s=n(10),i=n.n(s),d=n(16),f=n(9),l=n(18),b=n(56),m=function(e){return new Promise((function(t){return setTimeout(t,e)}))},p=function(e,t){return t.find((function(t){return t.id===e}))},h=function(e,t){return t.map((function(t){return e.find((function(e){return t.id===e.id}))||t}))},O=function(e,t){return t.filter((function(t){return!e.find((function(e){return t.id===e.id}))||t}))},v=function(){var e=Object(d.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.googleapis.com/books/v1/volumes?q=book");case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(e){return{title:e.volumeInfo&&e.volumeInfo.title,author:e.volumeInfo&&e.volumeInfo.authors&&e.volumeInfo.authors[0]||"Unknown Author",published_date:e.volumeInfo&&e.volumeInfo.publishedDate||(new Date).toISOString().split("T"),book_cover:e.volumeInfo&&e.volumeInfo.imageLinks&&e.volumeInfo.imageLinks.thumbnail||"https://via.placeholder.com/150x150.png",quantity:Math.floor(Math.floor(100*Math.random())%100)}},k=function(){var e=Object(d.a)(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v(),e.next=3,t;case 3:return e.t0=function(e){return j(e)},n=e.sent.items.map(e.t0),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(e,t){return[Object(u.a)({},e,{quantity:1})].concat(Object(o.a)(t))},y=function(e,t){return t.filter((function(t){return t.id!==e.id}))},w=function(e,t){return t.map((function(t){return t.id===e.id?Object(u.a)({},e,{quantity:t.quantity+1}):t}))},E=function(e,t){return t.map((function(t){return t.id===e.id?Object(u.a)({},e,{quantity:t.quantity-1}):t}))},x=function(e,t){return e===f.b.admin?function(e){var t;return t={},Object(c.a)(t,l.b.canceled,[l.b.paid,l.b.paid].includes(e)),Object(c.a)(t,l.b.sent,[l.b.paid,l.b.paid].includes(e)),t}(t):function(e){var t;return t={},Object(c.a)(t,l.b.canceled,e===l.b.new),Object(c.a)(t,l.b.paid,e===l.b.new),t}(t)},I=function(e,t){var n=null;return{get:function(){return n||(n=function(e,t){return JSON.parse(localStorage.getItem(e)||"".concat(t))}(e,t))},set:function(t){n=t,function(e,t){localStorage.setItem(e,JSON.stringify(t))}(e,t)}}},S=function(e){return function(){var t=Object(d.a)(i.a.mark((function t(n){var r,a,c,u=arguments;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.role===f.b.admin){t.next=2;break}throw new Error("You are not allowed to excute this request");case 2:for(r=u.length,a=new Array(r>1?r-1:0),c=1;c<r;c++)a[c-1]=u[c];return t.abrupt("return",e.apply(void 0,a));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},M=function(e){var t=I(e,JSON.stringify({items:{},keys:[]}));return{getItems:function(){var e=Object(d.a)(i.a.mark((function e(){var n,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(1e3);case 2:return n=t.get(),r=n.items,a=n.keys,e.abrupt("return",a.map((function(e){return r[e]})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),createItem:function(){var e=Object(d.a)(i.a.mark((function e(n){var r,a,s,d,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(1e3);case 2:return r=t.get(),a=r.keys,s=r.items,d=Object(u.a)({},n,{id:Object(b.uuid)()}),f={keys:[].concat(Object(o.a)(a),[d.id]),items:Object(u.a)({},s,Object(c.a)({},d.id,d))},t.set(f),e.abrupt("return",d);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),createItems:function(){var e=Object(d.a)(i.a.mark((function e(n){var r,a,s,d,f,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(1e3);case 2:return r=t.get(),a=r.keys,s=r.items,d=n.map((function(e){return Object(u.a)({},e,{id:Object(b.uuid)()})})),f=d.reduce((function(e,t){return Object(u.a)({},e,Object(c.a)({},t.id,t))}),{}),l={keys:[].concat(Object(o.a)(a),Object(o.a)(Object.keys(f))),items:Object(u.a)({},s,{},f)},t.set(l),e.abrupt("return",d);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateItem:function(){var e=Object(d.a)(i.a.mark((function e(n){var r,a,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(1e3);case 2:if(r=t.get(),a=r.keys,o=r.items,!n.id||!o[n.id]){e.next=7;break}return s={keys:a,items:Object(u.a)({},o,Object(c.a)({},n.id,n))},t.set(s),e.abrupt("return",n);case 7:throw new Error("Item does not exist");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateItems:function(){var e=Object(d.a)(i.a.mark((function e(n){var r,a,o,s,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(1e3);case 2:return r=t.get(),a=r.keys,o=r.items,s=n.reduce((function(e,t){return Object(u.a)({},e,Object(c.a)({},t.id||"",t))}),{}),d={keys:a,items:Object(u.a)({},o,{},s)},t.set(d),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteItem:function(){var e=Object(d.a)(i.a.mark((function e(n){var c,u,o,s,d,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(1e3);case 2:if(c=t.get(),u=c.keys,!(o=c.items)[n]){e.next=8;break}return s=o[n],d=Object(r.a)(o,[n].map(a.a)),f={keys:u.filter((function(e){return e!==n})),items:d},t.set(f),e.abrupt("return",s);case 8:throw new Error("Item does not exist");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteItems:function(){var e=Object(d.a)(i.a.mark((function e(n){var r,a,o,s,d,f,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m(1e3);case 2:return r=t.get(),a=r.keys,o=r.items,s=n.map((function(e){return o[e]})),d=a.filter((function(e){return!n.includes(e)})),f=d.reduce((function(e,t){return Object(u.a)({},e,Object(c.a)({},t,o[t]))}),{}),l={keys:a,items:f},t.set(l),e.abrupt("return",s);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}},36:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.setItems="cart/setCart",e.addItems="cart/add",e.removeItems="cart/remove",e.updateItems="cart/update",e.fetchStart="cart/fetchStart",e.fetchEnd="cart/fetchEnd"}(r||(r={}))},37:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.setBooks="books/setBooks",e.updateBooks="books/updateBooks",e.addBooks="books/addBooks",e.deleteBooks="books/deleteBooks",e.fetchStart="books/fetchStart",e.fetchEnd="books/fetchEnd"}(r||(r={}))},42:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.set="me/set",e.clear="me/clear"}(r||(r={}))},46:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(9),a={"/":{name:"Books",roles:[r.b.admin,r.b.client],href:function(){return"/"}},"/book-list":{name:"Book List",roles:[r.b.admin],href:function(){return"/book-list"}},"/my-orders":{name:"My Orders",roles:[r.b.client],href:function(){return"/my-orders"}},"/my-orders/:orderId":{name:"My Orders",roles:[r.b.client],noNav:!0,href:function(e){return"/my-orders/".concat(e)}},"/users":{name:"User List",roles:[r.b.admin],href:function(){return"/users"}},"/users/:userId/orders":{name:"My Orders",roles:[r.b.admin,r.b.client],noNav:!0,href:function(e){return"/users/".concat(e,"/orders")}},"/users/:userId/orders/:orderId":{name:"My Orders",roles:[r.b.admin,r.b.client],noNav:!0,href:function(e,t){return"/users/".concat(e,"/orders/").concat(t)}},"/logout":{name:"Logout",roles:[r.b.admin,r.b.client],href:function(){return"/logout"}}}},49:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(26),a=n(0),c=n(51),u=n(20),o=function(){return Object(r.c)((function(e){return e.me}))},s=function(){var e=function(){var e=Object(r.b)();return{clearMe:Object(a.useCallback)((function(){return e(Object(c.a)())}),[e])}}().clearMe,t=Object(u.f)().push;Object(a.useEffect)((function(){t("/"),e()}),[e,t])}},51:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(42),a=function(e){return{type:r.a.set,payload:{me:e}}},c=function(){return{type:r.a.clear}}},57:function(e,t,n){"use strict";var r=n(0),a=n(26),c=n(10),u=n.n(c),o=n(16),s=n(9),i=n(30),d=Object(i.c)("users"),f=d.getItems,l=d.createItems,b=f,m=l,p=function(){var e=Object(o.a)(u.a.mark((function e(t,n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b();case 2:if(r=e.sent,!(a=r.find((function(e){return e.username===t&&e.password===n})))){e.next=6;break}return e.abrupt("return",a);case 6:throw new Error("Incorrect credentials");case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=n(51),O=[{id:"1",name:"Yagami",surname:"Light",username:"Kira",password:"DeathNode",role:s.b.admin},{id:"2",name:"User",surname:"Some",username:"simple",password:"123",role:s.b.client}],v=function(e){return{type:s.a.setUsers,payload:{users:e}}},j=function(){return{type:s.a.fetchStart}},k=function(e){return{type:s.a.fetchEnd,payload:{errorMessage:e}}},g=n(20),y=n(49);n.d(t,"c",(function(){return w})),n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return x}));var w=function(e){var t=Object(a.b)(),n=Object(a.c)((function(e){return e.users})),c=n.users,s=n.loading,i=n.hasLoaded,d=n.errorMessage;return Object(r.useEffect)((function(){i&&!e||s||t(function(){var e=Object(o.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(j()),e.prev=1,e.next=4,b();case 4:if(0!==(n=e.sent).length){e.next=10;break}return e.next=8,m(O);case 8:r=e.sent,t(v(r));case 10:n&&t(v(n)),t(k()),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0),t(k());case 18:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}())}),[i,s,e,t]),{users:c,loading:s,hasLoaded:i,errorMessage:d}},E=function(){var e=Object(a.b)(),t=Object(a.c)((function(e){return e.me})).me,n=Object(a.c)((function(e){return e.users})),c=n.errorMessage,s=n.loading;return{authenticated:Object(r.useMemo)((function(){return!!t}),[t]),authenticate:Object(r.useCallback)((function(t,n){e(function(e,t){return function(){var n=Object(o.a)(u.a.mark((function n(r){var a;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r(j()),n.prev=1,n.next=4,p(e,t);case 4:a=n.sent,r(Object(h.b)(a)),r(k()),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(1),console.log(n.t0),r(k(n.t0.message));case 13:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e){return n.apply(this,arguments)}}()}(t,n))}),[e]),errorMessage:c,loading:s}},x=function(){var e=Object(y.b)().me,t=Object(g.f)().push;Object(r.useEffect)((function(){e&&e.role!==s.b.admin&&t("/")}),[e,t])}},88:function(e,t,n){e.exports=n(111)},9:function(e,t,n){"use strict";var r,a;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.setUsers="users/setUsers",e.updateUsers="users/updateUsers",e.removeUsers="users/removeUsers",e.addUsers="users/addUsers",e.fetchStart="users/fetchStart",e.fetchEnd="users/fetchEnd"}(r||(r={})),function(e){e.admin="admin",e.client="client"}(a||(a={}))}},[[88,2,3]]]);
//# sourceMappingURL=main.b0d1cb3f.chunk.js.map